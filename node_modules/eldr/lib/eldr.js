/*
License https://www.apache.org/licenses/LICENSE-2.0 Apache-2.0
Original Author Nito T.M. (https://github.com/nitotm)
*/
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var _ELDR_instances, _ELDR_languageData, _ELDR_doCleanText, _ELDR_calculateScores;
import { dictionary } from "./dictionary.js";
import { LanguageData } from "./language-data.js";
import { LanguageResult } from "./language-result.js";
import { matchDomains, separators } from "./regex-patterns.js";
export class ELDR {
    constructor(ngramModule) {
        _ELDR_instances.add(this);
        _ELDR_languageData.set(this, void 0);
        _ELDR_doCleanText.set(this, false);
        __classPrivateFieldSet(this, _ELDR_languageData, new LanguageData(ngramModule), "f");
    }
    detect(text) {
        if (typeof text !== "string") {
            return new LanguageResult("", [], 0, {});
        }
        if (__classPrivateFieldGet(this, _ELDR_doCleanText, "f")) {
            // Removes Urls, emails, alphanumerical & numbers
            text = getCleanTxt(text);
        }
        const byteWords = textProcessor(text);
        const byteNgrams = getByteNgrams(byteWords);
        const numNgrams = Object.keys(byteNgrams).length;
        const results = __classPrivateFieldGet(this, _ELDR_instances, "m", _ELDR_calculateScores).call(this, byteNgrams, numNgrams);
        let iso639_1 = "";
        if (results.length > 0) {
            results.sort((a, b) => b[1] - a[1]);
            iso639_1 = __classPrivateFieldGet(this, _ELDR_languageData, "f").langCodes[results[0][0]];
        }
        return new LanguageResult(iso639_1, results, numNgrams, __classPrivateFieldGet(this, _ELDR_languageData, "f").langCodes);
    }
    info() {
        return {
            "Data type": __classPrivateFieldGet(this, _ELDR_languageData, "f").type,
            Languages: __classPrivateFieldGet(this, _ELDR_languageData, "f").langCodes,
        };
    }
    cleanText(doCleanText) {
        __classPrivateFieldSet(this, _ELDR_doCleanText, Boolean(doCleanText), "f");
    }
}
_ELDR_languageData = new WeakMap(), _ELDR_doCleanText = new WeakMap(), _ELDR_instances = new WeakSet(), _ELDR_calculateScores = function _ELDR_calculateScores(byteNgrams, numNgrams) {
    let relevancy;
    const langScore = [...__classPrivateFieldGet(this, _ELDR_languageData, "f").langScore];
    for (const bytes in byteNgrams) {
        const frequency = byteNgrams[bytes];
        const thisByte = __classPrivateFieldGet(this, _ELDR_languageData, "f").ngrams[bytes];
        if (thisByte) {
            const langCount = Object.keys(thisByte).length;
            // Ngram score multiplier, the fewer languages found the more relevancy. Formula can be fine-tuned.
            if (langCount === 1) {
                relevancy = 27; // Handpicked relevance multiplier, trial-error
            }
            else if (langCount < 16) {
                relevancy = (16 - langCount) / 2 + 1;
            }
            else {
                relevancy = 1;
            }
            // Most time-consuming loop, do only the strictly necessary inside
            for (const lang in thisByte) {
                const globalFrequency = thisByte[lang];
                langScore[lang] +=
                    (frequency > globalFrequency
                        ? globalFrequency / frequency
                        : frequency / globalFrequency) *
                        relevancy +
                        2;
            }
        }
    }
    // This divisor will produce a final score between 0 - ~1, score could be >1. Can be improved.
    const resultDivisor = numNgrams * 3.2;
    const results = [];
    for (const [lang, score] of langScore.entries()) {
        if (score) {
            // Javascript does Not guarantee object order, so a multi-array is used
            results.push([lang, score / resultDivisor]); // * LanguageData.scoreNormalizer[lang];
        }
    }
    return results;
};
/**
 * Removes parts of a string, that may be considered as "noise" for language detection
 *
 * @param {string} str
 * @returns {string}
 */
function getCleanTxt(str) {
    // Remove URLS
    str = str.replaceAll(/[hw]((ttps?:\/\/(www\.)?)|ww\.)([^\s#./?-]+\.?)+(\/\S*)?/gi, " ");
    // Remove emails
    str = str.replaceAll(/[\w!$%&+.`â€™-]+@[\d.A-Za-z-]+\.[\dA-Za-z-]{2,64}/g, " ");
    // Remove .com domains
    str = str.replace(matchDomains, " ");
    // Remove alphanumerical/number codes
    str = str.replaceAll(/[A-Za-z]*\d+[\dA-Za-z]*/g, " ");
    return str;
}
/**
 * @param {string} text
 * @returns {Array}
 */
function textProcessor(text) {
    text = text.slice(0, 1000);
    // Normalize special characters/word separators
    text = text.replace(separators, " ");
    text = text.trim().toLowerCase();
    return strToUtf8Bytes(text); // Returns array of words
}
/**
 * Gets Ngrams from a given array of words
 *
 * @param {Array} words
 * @returns {Object}
 */
function getByteNgrams(words) {
    const byteNgrams = {};
    let countNgrams = 0;
    let thisBytes;
    let j;
    for (const word of words) {
        const len = Math.min(word.length, 70);
        for (j = 0; j + 4 < len; j += 3, ++countNgrams) {
            thisBytes = (j === 0 ? " " : "") + word.slice(j, j + 4);
            byteNgrams[thisBytes] =
                byteNgrams[thisBytes] === undefined ? 1 : byteNgrams[thisBytes] + 1;
        }
        thisBytes =
            (j === 0 ? " " : "") +
                word.slice(Math.max(0, Math.max(0, len === 3 ? 0 : len - 4))) +
                " ";
        byteNgrams[thisBytes] =
            byteNgrams[thisBytes] === undefined ? 1 : byteNgrams[thisBytes] + 1;
        countNgrams++;
    }
    // Frequency is multiplied by 15000 at the ngrams database. A reduced number (13200) seems to work better.
    // Linear formulas were tried, decreasing the multiplier for fewer ngram strings, no meaningful improvement.
    for (const bytes in byteNgrams) {
        byteNgrams[bytes] = (byteNgrams[bytes] / countNgrams) * 13200;
    }
    return byteNgrams;
}
/**
 * Converts each byte to a single character, using our own dictionary, since javascript does not allow raw byte
 * strings or invalid UTF-8 characters. We could use TextEncoder() to create an Uint8Array, and then translate to our
 * dictionary, but this function is overall faster as it does both jobs at once
 *
 * Alternatives such as just using Uint8Array/hex for detection adds complexity and or a bigger database
 *
 * @param {string} str
 * @returns {Array}
 */
function strToUtf8Bytes(str) {
    let encoded = "";
    const words = [];
    let countBytes = 0;
    const cutAfter = 350; // Cut to first whitespace after 350 byte length offset
    const enforceCutAfter = 380; // Cut after any UTF-8 character when surpassing 380 byte length
    for (let ii = 0; ii < str.length; ii++) {
        let charCode = str.codePointAt(ii);
        if (charCode === undefined) {
            break;
        }
        if (charCode < 0x80) {
            if (charCode === 32) {
                if (encoded !== "") {
                    words.push(encoded);
                    encoded = "";
                }
                if (countBytes > cutAfter) {
                    break;
                }
            }
            else {
                encoded += str[ii];
            }
            countBytes++;
        }
        else if (charCode < 2048) {
            encoded +=
                dictionary[0xc0 | (charCode >> 6)] +
                    dictionary[0x80 | (charCode & 0x3f)];
            countBytes += 2;
        }
        else if (charCode < 55296 || charCode >= 57344) {
            encoded +=
                dictionary[0xe0 | (charCode >> 12)] +
                    dictionary[0x80 | ((charCode >> 6) & 0x3f)] +
                    dictionary[0x80 | (charCode & 0x3f)];
            countBytes += 3;
        }
        else {
            // UTF-16
            ii++;
            charCode =
                65536 +
                    (((charCode & 1023) << 10) | ((str.codePointAt(ii) ?? 0) & 1023));
            encoded +=
                dictionary[0xf0 | (charCode >> 18)] +
                    dictionary[0x80 | ((charCode >> 12) & 0x3f)] +
                    dictionary[0x80 | ((charCode >> 6) & 0x3f)] +
                    dictionary[0x80 | (charCode & 0x3f)];
            countBytes += 4;
        }
        if (countBytes > enforceCutAfter) {
            break;
        }
    }
    if (encoded !== "") {
        words.push(encoded);
        // It is faster to build the array than to words.split(/ +/).filter((x) => x !== ' ') later
    }
    return words;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxkci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGRyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7RUFHRTs7Ozs7Ozs7Ozs7OztBQUVGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUM3QyxPQUFPLEVBQUUsWUFBWSxFQUFlLE1BQU0sb0JBQW9CLENBQUM7QUFDL0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFL0QsTUFBTSxPQUFPLElBQUk7SUFJZixZQUFZLFdBQXdCOztRQUhwQyxxQ0FBNEI7UUFDNUIsNEJBQWUsS0FBSyxFQUFDO1FBR25CLHVCQUFBLElBQUksc0JBQWlCLElBQUksWUFBWSxDQUFDLFdBQVcsQ0FBQyxNQUFBLENBQUM7SUFDckQsQ0FBQztJQUVELE1BQU0sQ0FBQyxJQUFZO1FBQ2pCLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQzVCLE9BQU8sSUFBSSxjQUFjLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDMUM7UUFFRCxJQUFJLHVCQUFBLElBQUkseUJBQWEsRUFBRTtZQUNyQixpREFBaUQ7WUFDakQsSUFBSSxHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUMxQjtRQUVELE1BQU0sU0FBUyxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0QyxNQUFNLFVBQVUsR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDNUMsTUFBTSxTQUFTLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDakQsTUFBTSxPQUFPLEdBQXVCLHVCQUFBLElBQUksOENBQWlCLE1BQXJCLElBQUksRUFDdEMsVUFBVSxFQUNWLFNBQVMsQ0FDVixDQUFDO1FBQ0YsSUFBSSxRQUFRLEdBQUcsRUFBRSxDQUFDO1FBRWxCLElBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDdEIsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwQyxRQUFRLEdBQUcsdUJBQUEsSUFBSSwwQkFBYyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN4RDtRQUVELE9BQU8sSUFBSSxjQUFjLENBQ3ZCLFFBQVEsRUFDUixPQUFPLEVBQ1AsU0FBUyxFQUNULHVCQUFBLElBQUksMEJBQWMsQ0FBQyxTQUFTLENBQzdCLENBQUM7SUFDSixDQUFDO0lBRUQsSUFBSTtRQUNGLE9BQU87WUFDTCxXQUFXLEVBQUUsdUJBQUEsSUFBSSwwQkFBYyxDQUFDLElBQUk7WUFDcEMsU0FBUyxFQUFFLHVCQUFBLElBQUksMEJBQWMsQ0FBQyxTQUFTO1NBQ3hDLENBQUM7SUFDSixDQUFDO0lBK0NELFNBQVMsQ0FBQyxXQUFvQjtRQUM1Qix1QkFBQSxJQUFJLHFCQUFnQixPQUFPLENBQUMsV0FBVyxDQUFDLE1BQUEsQ0FBQztJQUMzQyxDQUFDO0NBQ0Y7K0pBaERrQixVQUFrQyxFQUFFLFNBQWlCO0lBQ3BFLElBQUksU0FBUyxDQUFDO0lBQ2QsTUFBTSxTQUFTLEdBQWEsQ0FBQyxHQUFHLHVCQUFBLElBQUksMEJBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUU5RCxLQUFLLE1BQU0sS0FBSyxJQUFJLFVBQVUsRUFBRTtRQUM5QixNQUFNLFNBQVMsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEMsTUFBTSxRQUFRLEdBQUcsdUJBQUEsSUFBSSwwQkFBYyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVsRCxJQUFJLFFBQVEsRUFBRTtZQUNaLE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDO1lBQy9DLG1HQUFtRztZQUNuRyxJQUFJLFNBQVMsS0FBSyxDQUFDLEVBQUU7Z0JBQ25CLFNBQVMsR0FBRyxFQUFFLENBQUMsQ0FBQywrQ0FBK0M7YUFDaEU7aUJBQU0sSUFBSSxTQUFTLEdBQUcsRUFBRSxFQUFFO2dCQUN6QixTQUFTLEdBQUcsQ0FBQyxFQUFFLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUN0QztpQkFBTTtnQkFDTCxTQUFTLEdBQUcsQ0FBQyxDQUFDO2FBQ2Y7WUFFRCxrRUFBa0U7WUFDbEUsS0FBSyxNQUFNLElBQUksSUFBSSxRQUFRLEVBQUU7Z0JBQzNCLE1BQU0sZUFBZSxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDdkMsU0FBUyxDQUFDLElBQUksQ0FBQztvQkFDYixDQUFDLFNBQVMsR0FBRyxlQUFlO3dCQUMxQixDQUFDLENBQUMsZUFBZSxHQUFHLFNBQVM7d0JBQzdCLENBQUMsQ0FBQyxTQUFTLEdBQUcsZUFBZSxDQUFDO3dCQUM5QixTQUFTO3dCQUNYLENBQUMsQ0FBQzthQUNMO1NBQ0Y7S0FDRjtJQUVELDhGQUE4RjtJQUM5RixNQUFNLGFBQWEsR0FBRyxTQUFTLEdBQUcsR0FBRyxDQUFDO0lBQ3RDLE1BQU0sT0FBTyxHQUF1QixFQUFFLENBQUM7SUFDdkMsS0FBSyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLFNBQVMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtRQUMvQyxJQUFJLEtBQUssRUFBRTtZQUNULHVFQUF1RTtZQUN2RSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLEtBQUssR0FBRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsd0NBQXdDO1NBQ3RGO0tBQ0Y7SUFFRCxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDO0FBT0g7Ozs7O0dBS0c7QUFDSCxTQUFTLFdBQVcsQ0FBQyxHQUFXO0lBQzlCLGNBQWM7SUFDZCxHQUFHLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FDbEIsNERBQTRELEVBQzVELEdBQUcsQ0FDSixDQUFDO0lBQ0YsZ0JBQWdCO0lBQ2hCLEdBQUcsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzlFLHNCQUFzQjtJQUN0QixHQUFHLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDckMscUNBQXFDO0lBQ3JDLEdBQUcsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ3RELE9BQU8sR0FBRyxDQUFDO0FBQ2IsQ0FBQztBQUVEOzs7R0FHRztBQUNILFNBQVMsYUFBYSxDQUFDLElBQVk7SUFDakMsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzNCLCtDQUErQztJQUMvQyxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDckMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNqQyxPQUFPLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLHlCQUF5QjtBQUN4RCxDQUFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFTLGFBQWEsQ0FBQyxLQUFlO0lBQ3BDLE1BQU0sVUFBVSxHQUEyQixFQUFFLENBQUM7SUFDOUMsSUFBSSxXQUFXLEdBQUcsQ0FBQyxDQUFDO0lBQ3BCLElBQUksU0FBaUIsQ0FBQztJQUN0QixJQUFJLENBQUMsQ0FBQztJQUVOLEtBQUssTUFBTSxJQUFJLElBQUksS0FBSyxFQUFFO1FBQ3hCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQztRQUV0QyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRTtZQUM5QyxTQUFTLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztZQUN4RCxVQUFVLENBQUMsU0FBUyxDQUFDO2dCQUNuQixVQUFVLENBQUMsU0FBUyxDQUFDLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDdkU7UUFFRCxTQUFTO1lBQ1AsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDcEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM3RCxHQUFHLENBQUM7UUFDTixVQUFVLENBQUMsU0FBUyxDQUFDO1lBQ25CLFVBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN0RSxXQUFXLEVBQUUsQ0FBQztLQUNmO0lBRUQsMEdBQTBHO0lBQzFHLDRHQUE0RztJQUM1RyxLQUFLLE1BQU0sS0FBSyxJQUFJLFVBQVUsRUFBRTtRQUM5QixVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsV0FBVyxDQUFDLEdBQUcsS0FBTSxDQUFDO0tBQ2hFO0lBRUQsT0FBTyxVQUFVLENBQUM7QUFDcEIsQ0FBQztBQUVEOzs7Ozs7Ozs7R0FTRztBQUNILFNBQVMsY0FBYyxDQUFDLEdBQVc7SUFDakMsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBQ2pCLE1BQU0sS0FBSyxHQUFhLEVBQUUsQ0FBQztJQUMzQixJQUFJLFVBQVUsR0FBRyxDQUFDLENBQUM7SUFDbkIsTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDLENBQUMsdURBQXVEO0lBQzdFLE1BQU0sZUFBZSxHQUFHLEdBQUcsQ0FBQyxDQUFDLGdFQUFnRTtJQUU3RixLQUFLLElBQUksRUFBRSxHQUFHLENBQUMsRUFBRSxFQUFFLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxFQUFFLEVBQUUsRUFBRTtRQUN0QyxJQUFJLFFBQVEsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ25DLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtZQUMxQixNQUFNO1NBQ1A7UUFFRCxJQUFJLFFBQVEsR0FBRyxJQUFJLEVBQUU7WUFDbkIsSUFBSSxRQUFRLEtBQUssRUFBRSxFQUFFO2dCQUNuQixJQUFJLE9BQU8sS0FBSyxFQUFFLEVBQUU7b0JBQ2xCLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7b0JBQ3BCLE9BQU8sR0FBRyxFQUFFLENBQUM7aUJBQ2Q7Z0JBRUQsSUFBSSxVQUFVLEdBQUcsUUFBUSxFQUFFO29CQUN6QixNQUFNO2lCQUNQO2FBQ0Y7aUJBQU07Z0JBQ0wsT0FBTyxJQUFJLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUNwQjtZQUVELFVBQVUsRUFBRSxDQUFDO1NBQ2Q7YUFBTSxJQUFJLFFBQVEsR0FBRyxJQUFNLEVBQUU7WUFDNUIsT0FBTztnQkFDTCxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxJQUFJLENBQUMsQ0FBQyxDQUFDO29CQUNsQyxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDdkMsVUFBVSxJQUFJLENBQUMsQ0FBQztTQUNqQjthQUFNLElBQUksUUFBUSxHQUFHLEtBQU8sSUFBSSxRQUFRLElBQUksS0FBTyxFQUFFO1lBQ3BELE9BQU87Z0JBQ0wsVUFBVSxDQUFDLElBQUksR0FBRyxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQztvQkFDbkMsVUFBVSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsUUFBUSxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO29CQUMzQyxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDdkMsVUFBVSxJQUFJLENBQUMsQ0FBQztTQUNqQjthQUFNO1lBQ0wsU0FBUztZQUNULEVBQUUsRUFBRSxDQUFDO1lBQ0wsUUFBUTtnQkFDTixLQUFTO29CQUNULENBQUMsQ0FBQyxDQUFDLFFBQVEsR0FBRyxJQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ3hFLE9BQU87Z0JBQ0wsVUFBVSxDQUFDLElBQUksR0FBRyxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQztvQkFDbkMsVUFBVSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsUUFBUSxJQUFJLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO29CQUM1QyxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7b0JBQzNDLFVBQVUsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUN2QyxVQUFVLElBQUksQ0FBQyxDQUFDO1NBQ2pCO1FBRUQsSUFBSSxVQUFVLEdBQUcsZUFBZSxFQUFFO1lBQ2hDLE1BQU07U0FDUDtLQUNGO0lBRUQsSUFBSSxPQUFPLEtBQUssRUFBRSxFQUFFO1FBQ2xCLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDcEIsMkZBQTJGO0tBQzVGO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDIn0=